TEST tandem-genotypes --help
Usage: tandem-genotypes [options] microsat.txt alignments.maf

Try to indicate genotypes of tandem repeats.

Options:
  -h, --help            show this help message and exit
  -g FILE, --genes=FILE
                        read genes from a genePred or BED file
  -m PROB, --mismap=PROB
                        ignore any alignment with mismap probability > PROB
                        (default=1e-06)
  --postmask=NUMBER     ignore mostly-lowercase alignments (default=1)
  -p BP, --promoter=BP  promoter length (default=300)
  -s N, --select=N      select: all repeats (0), non-intergenic repeats (1),
                        non-intergenic non-intronic repeats (2) (default=0)
  -u BP, --min-unit=BP  ignore repeats with unit shorter than BP (default=2)
  -f BP, --far=BP       require alignment >= BP beyond both sides of a repeat
                        (default=100)
  -n BP, --near=BP      count insertions <= BP beyond a repeat (default=60)
  --mode=LETTER         L=lenient, S=strict (default=L)
  -v, --verbose         show more details

TEST tandem-genotypes microsat.txt nano.maf
# tandem-genotypes microsat.txt nano.maf
chr22	41994883	41994923	TG	.	.	-7,-6,-4,-3,-1,0,0,2,3,4,8	-16,-14,-12,-11,-11,-11,-9,-8,-7

TEST tandem-genotypes -s2 -g refFlat.txt simpleRepeat.txt nano.maf
# tandem-genotypes -s2 -g refFlat.txt simpleRepeat.txt nano.maf
chr22	41994883	41994923	TG	SEPT3	3'UTR	-7,-6,-4,-3,-1,0,0,2,3,4,8	-16,-14,-12,-11,-11,-11,-9,-8,-7
chr22	41958483	41958508	GA	LINC00634	exon	-9,-8,-8,-8,-7,-7,-7,-4	-4,-4,-3,-2,-2,-2,-2,-2,-1,-1,-1,-1,0,1,1,2
chr22	41926181	41926216	CCAGGACCAGCG	TNFRSF13C	coding	-1,0,0,0,0,0,0	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
chr22	41976784	41976818	GCGGCTGGCAGCGGCG	SEPT3	promoter	0,0,0,0,0,0,0,0	0,0,0,0,0,0,0,0,0,0,0,0

TEST tandem-genotypes -s2 -v -g refFlat.txt simpleRepeat.txt nano.maf
reading refFlat.txt...
reading simpleRepeat.txt...
reading nano.maf...
# tandem-genotypes -s2 -v -g refFlat.txt simpleRepeat.txt nano.maf
chr22	41994883	41994923	TG	SEPT3	3'UTR	-7:551111640.524077,-6:2567311907.307357,-4:4239353418.326057,-3:288418386.235196,-1:3843483077.2404,0:4245879798.221634,0:84868110.417637,2:4239353418.317926,3:216722908.333390,4:216722908.1709,8:622291475.142691	-16:4179682758.397431,-14:4239353418.504478,-12:4045668814.734681,-11:356443753.4648,-11:4045668814.183140,-11:4045668814.609745,-9:288286712.337975,-8:4246400039.382250,-7:288418386.391961
chr22	41958483	41958508	GA	LINC00634	exon	-9:152889212.45112,-8:352384898.298207,-8:3709921973.402391,-8:622291475.287491,-7:152889212.152558,-7:3775529215.186587,-7:3843483077.384706,-4:2567311907.26716	-4:3574887596.301650,-4:551111640.334841,-3:551111640.466329,-2:216722908.102623,-2:2567311907.241143,-2:288286712.467921,-2:353303576.124645,-2:481119249.119161,-1:4244727060.265479,-1:4246400039.335031,-1:622291475.156702,-1:622291475.27467,0:4045668814.403445,1:4246400039.371226,1:86567043.39260,2:4239353418.118756
chr22	41926181	41926216	CCAGGACCAGCG	TNFRSF13C	coding	-1:84868110.682860,0:19064779.75931,0:216722908.247454,0:216722908.458864,0:288286712.341693,0:3976885577.45859,0:4045668814.202393	0:216722908.191156,0:216722908.374159,0:288418386.463180,0:353303576.423872,0:353303576.610171,0:356443753.208271,0:3843483077.135505,0:4045668814.121505,0:4045668814.149539,0:4179682758.115941,0:4179682758.29175,0:4239353418.540835,0:4245879798.88099,0:551111640.357287,0:622291475.174944,0:622291475.574473,0:87746129.42189
chr22	41976784	41976818	GCGGCTGGCAGCGGCG	SEPT3	promoter	0:19064779.61037,0:285174896.31372,0:3306352129.20519,0:353303576.183171,0:4111103328.87540,0:4177064552.106228,0:4245879798.221634,0:83756522.161684	0:222619780.120942,0:288286712.353242,0:288418386.213437,0:353303576.232635,0:356443753.185671,0:3573838535.181173,0:4239353418.715177,0:481119249.218749,0:551111640.193940,0:551111640.454697,0:622291475.107934,0:84868110.77679

TEST tandem-genotypes -s2 -g refGene.txt rmsk.txt nano.maf
# tandem-genotypes -s2 -g refGene.txt rmsk.txt nano.maf
chr22	41994883	41994923	TG	SEPT3	3'UTR	-7,-6,-4,-3,-1,0,0,2,3,4,8	-16,-14,-12,-11,-11,-11,-9,-8,-7
chr22	41914573	41914611	GCGCGA	SHISA8	coding	-1,-1,0,0,0,0,0,0,0,1,1	-1,0,0,0,0,0,0,0,0,0,0,0
chr22	41958483	41958508	GA	LINC00634	exon	-9,-8,-8,-8,-7,-7,-7,-4	-4,-4,-3,-2,-2,-2,-2,-2,-1,-1,-1,-1,0,1,1,2
chr22	41926170	41926217	CACCAG	TNFRSF13C	coding	-3,-1,-1,0,0,0,0	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
chr22	41957928	41957963	CGCC	LINC00634	exon	-4,-3,-2,-1,0,0,0,0,0,2	-2,-1,-1,-1,-1,-1,0,0,0,0,0,0,1,1
chr22	41997631	41997667	CAAA	SEPT3	3'UTR	-2,-1,-1,0,0,0,0,0,0,1	0,0,0,0,0,0,1,1,2,5
chr22	41997742	41997789	CTTCCCC	SEPT3	3'UTR	-1,-1,-1,0,0,0,0,1	-1,0,0,0,0,0,0,0,1,2

TEST tandem-genotypes -s2 -g refFlat.txt rmsk.out nano.maf
# tandem-genotypes -s2 -g refFlat.txt rmsk.out nano.maf
chr22	41994883	41994923	TG	SEPT3	3'UTR	-7,-6,-4,-3,-1,0,0,2,3,4,8	-16,-14,-12,-11,-11,-11,-9,-8,-7
chr22	41914573	41914611	GCGCGA	SHISA8	coding	-1,-1,0,0,0,0,0,0,0,1,1	-1,0,0,0,0,0,0,0,0,0,0,0
chr22	41958483	41958508	GA	LINC00634	exon	-9,-8,-8,-8,-7,-7,-7,-4	-4,-4,-3,-2,-2,-2,-2,-2,-1,-1,-1,-1,0,1,1,2
chr22	41926170	41926217	CACCAG	TNFRSF13C	coding	-3,-1,-1,0,0,0,0	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
chr22	41957928	41957963	CGCC	LINC00634	exon	-4,-3,-2,-1,0,0,0,0,0,2	-2,-1,-1,-1,-1,-1,0,0,0,0,0,0,1,1
chr22	41997631	41997667	CAAA	SEPT3	3'UTR	-2,-1,-1,0,0,0,0,0,0,1	0,0,0,0,0,0,1,1,2,5
chr22	41997742	41997789	CTTCCCC	SEPT3	3'UTR	-1,-1,-1,0,0,0,0,1	-1,0,0,0,0,0,0,0,1,2

TEST tandem-genotypes -s0 -g refFlat.txt simpleRepeat.txt nano.maf
# tandem-genotypes -s0 -g refFlat.txt simpleRepeat.txt nano.maf
chr22	41939778	41939907	AAAG	CENPM	intron	-29,141,148,151	156,192,209,225,225,226,229,234,241
chr22	41994883	41994923	TG	SEPT3	3'UTR	-7,-6,-4,-3,-1,0,0,2,3,4,8	-16,-14,-12,-11,-11,-11,-9,-8,-7
chr22	41958483	41958508	GA	LINC00634	exon	-9,-8,-8,-8,-7,-7,-7,-4	-4,-4,-3,-2,-2,-2,-2,-2,-1,-1,-1,-1,0,1,1,2
chr22	41978893	41978931	GGA	SEPT3	intron	-9,-6,-5,-3,-2,-2,-1,0,1	-1,-1,-1,1,1,1,1,4,4
chr22	41962342	41962394	TTTCCTTTTTTTTTTTTTCTTTTTTCT	.	intergenic	-2,-2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1	-2,-2,-2,-2,-2,-2,-2,-2,-2,-1,-1,-1,-1,-1
chr22	41982508	41982533	AAAACAA	SEPT3	intron	-1,0,0,0,0,0,0,0,0,1,1	-2,0,0,0,0,0,0,0,0
chr22	41991062	41991093	CAAA	SEPT3	intron	-1,-1,0,0,0,0,0,0,0,0,0,1,1,1	-1,-1,0,0,0,0,0,1,1
chr22	41961665	41961701	TTTTTTTTCTGTTTTTTG	.	intergenic	-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1	-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1
chr22	41916925	41916952	AAACAAAAAAAAAA	.	intergenic	-1,-1,-1,-1,-1,-1,-1,-1,0,0,1	-2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1
chr22	41961159	41961203	TTTA	.	intergenic	-2,-2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0	-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,1,1
chr22	41922713	41922797	AGATGGGGTGGG	.	intergenic	0,0,0,0,0,0,0,0	-1,-1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
chr22	41959510	41959535	AAACA	.	intergenic	0,0,0,0,0,0,0,1	-1,-1,-1,0,0,0,0,0,0,0,0,0,1,1
chr22	41915069	41915109	GCTCCG	.	intergenic	-1,0,0,0,0,0,1	-2,-1,0,0,0,0,0,0
chr22	41926181	41926216	CCAGGACCAGCG	TNFRSF13C	coding	-1,0,0,0,0,0,0	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
chr22	41916394	41916426	ACACACACATGT	.	intergenic	-1,0,0,0,0,0,0,0,0,0,0	0,0,0,0,0,0,0,0,0
chr22	41929081	41929146	GGTGTGGGTGAGCGTG	.	intergenic	0,0,0,0,0,0,0,0,0,0,0	-1,0,0,0,0,0,0,0,0,0,0,0,0,0
chr22	41922641	41922755	AGATGGGGTGGCCAGGAGA	.	intergenic	0,0,0,0,0,0,0,0	-1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
chr22	41922694	41922868	AGATGGGGTGGCCAGGAGAAGATGGGGTGGG	.	intergenic	0,0,0,0,0,0,0,0	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
chr22	41991064	41991093	AACAAACAAACAAAC	SEPT3	intron	0,0,0,0,0,0,0,0,0,0,0,0,0,0	0,0,0,0,0,0,0,0,0
chr22	41918884	41919148	CTAATTTTTGTAATTTTTAGTAGAGACAGGGTTTCACCATATTGAGCAGGCGGGTCGCGAACTCCTGACCTCAAGTGATCCGCCCGCCTCGGCCTCCCAAAATGCTGGGATTACAGGCGCGAGCCACGGGGCCCGGC	.	intergenic	0,0,0,0,0,0,0,0,0,0,0,0	0,0,0,0,0,0,0,0,0
chr22	41921279	41921907	AAAAAGGTCAAGGCTGGGCCGGGCACGATGGCTCACGCCTGTAATCCCAGCACTTTGGGAGGCCAAGGCGGACAGATCATGAGGTCAGGAGATCGAGACCAGCCTGGCCAACATGGAGAAACCCTATCTCTACTAAAAATACAAAAATTAGCCAGGCGTGGTAGCGCACGCCTGTAATCCCAGCTACTCAGGAGGCTGAGGCAGGAGAATCGCGTGAACCCGGGAGGCAGAGCCTACAGTGAGCCGAGATTGCACCACTGCACCCCAACCTGGGCAACAGAGCGAAACTCCATCTCAAAAAAAAAAAAAAAAC	.	intergenic	0,0,0,0,0,0,0,0,0	0,0,0,0,0,0,0,0,0,0,0,0
chr22	41976784	41976818	GCGGCTGGCAGCGGCG	SEPT3	promoter	0,0,0,0,0,0,0,0	0,0,0,0,0,0,0,0,0,0,0,0
chr22	41974299	41974474	GTGGCTCACACCTATAATCCCAGAACTCTGGGAGGCCAAGACAGGTGGATCACGAGGTCAGGAGATCAAGACCAGCCTGGCCAGGCCAGGCGTG	.	intergenic	0,0,0,0,0,0,0,0	0,0,0,0,0,0,0,0,0,0,0
chr22	41969689	41969747	GGGGGTGGAAGGGTGTGGGGGTGGGT	.	intergenic	0,0,0,0,0,0	0,0,0,0,0,0,0,0,0,0,0,0
chr22	41908806	41908942	TCACACACCTCAACCAGCCACAGCCCTGGCCCCTAGCCTCCCCACA	.	intergenic	0,0,0,0,0,0,0,0	0,0,0,0,0,0

TEST tandem-genotypes -s1 -g refFlat.txt simpleRepeat.txt nano.maf
# tandem-genotypes -s1 -g refFlat.txt simpleRepeat.txt nano.maf
chr22	41939778	41939907	AAAG	CENPM	intron	-29,141,148,151	156,192,209,225,225,226,229,234,241
chr22	41994883	41994923	TG	SEPT3	3'UTR	-7,-6,-4,-3,-1,0,0,2,3,4,8	-16,-14,-12,-11,-11,-11,-9,-8,-7
chr22	41958483	41958508	GA	LINC00634	exon	-9,-8,-8,-8,-7,-7,-7,-4	-4,-4,-3,-2,-2,-2,-2,-2,-1,-1,-1,-1,0,1,1,2
chr22	41978893	41978931	GGA	SEPT3	intron	-9,-6,-5,-3,-2,-2,-1,0,1	-1,-1,-1,1,1,1,1,4,4
chr22	41982508	41982533	AAAACAA	SEPT3	intron	-1,0,0,0,0,0,0,0,0,1,1	-2,0,0,0,0,0,0,0,0
chr22	41991062	41991093	CAAA	SEPT3	intron	-1,-1,0,0,0,0,0,0,0,0,0,1,1,1	-1,-1,0,0,0,0,0,1,1
chr22	41926181	41926216	CCAGGACCAGCG	TNFRSF13C	coding	-1,0,0,0,0,0,0	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
chr22	41991064	41991093	AACAAACAAACAAAC	SEPT3	intron	0,0,0,0,0,0,0,0,0,0,0,0,0,0	0,0,0,0,0,0,0,0,0
chr22	41976784	41976818	GCGGCTGGCAGCGGCG	SEPT3	promoter	0,0,0,0,0,0,0,0	0,0,0,0,0,0,0,0,0,0,0,0

TEST tandem-genotypes --postmask=0 near-beg.bed near-beg.maf
# tandem-genotypes --postmask=0 near-beg.bed near-beg.maf
ref	21	146	GGGGCC	.	.	21	.

TEST tandem-genotypes --postmask=0 small-rep.bed small-rep.maf
# tandem-genotypes --postmask=0 small-rep.bed small-rep.maf
ref	761	778	GGGGCC	.	.	53	.

TEST tandem-genotypes --postmask=0 far.bed far.maf
# tandem-genotypes --postmask=0 far.bed far.maf
chr3	63912686	63912715	CAG	.	.	64	.

TEST tandem-genotypes -u1 -s1 -g refFlat.txt simpleRepeat.txt nano.maf
# tandem-genotypes -u1 -s1 -g refFlat.txt simpleRepeat.txt nano.maf
chr22	41939778	41939907	AAAG	CENPM	intron	-29,141,148,151	156,192,209,225,225,226,229,234,241
chr22	41994883	41994923	TG	SEPT3	3'UTR	-7,-6,-4,-3,-1,0,0,2,3,4,8	-16,-14,-12,-11,-11,-11,-9,-8,-7
chr22	41958483	41958508	GA	LINC00634	exon	-9,-8,-8,-8,-7,-7,-7,-4	-4,-4,-3,-2,-2,-2,-2,-2,-1,-1,-1,-1,0,1,1,2
chr22	41957181	41957208	T	LINC00634	intron	-24,-23,-23,-22,-21,-21,-21,-21,-20,-19,-17,-17	-22,-22,-22,-21,-21,-21,-21,-20,-20,-20,-20,-20,-19,-18,-17,-15,-14
chr22	41953740	41953768	T	LINC00634	intron	-23,-23,-22,-22,-22,-22,-21,-21,-20,-19,-18,-18,-17	-24,-23,-23,-23,-22,-22,-22,-22,-21,-21,-19,-18
chr22	41980129	41980155	T	SEPT3	intron	-21,-21,-20,-20,-19,-19,-18,-14	-23,-22,-22,-22,-21,-19,-16,-14
chr22	41984845	41984870	T	SEPT3	intron	-21,-20,-20,-19,-19,-18,-18,-18,-17,-17,-17,-16,-16,-16,-15,-14,-13	-25,-20,-20,-20,-19,-19,-19,-18,-18,-18,-18,-18,-16,-15,-10
chr22	41978893	41978931	GGA	SEPT3	intron	-9,-6,-5,-3,-2,-2,-1,0,1	-1,-1,-1,1,1,1,1,4,4
chr22	41982508	41982533	AAAACAA	SEPT3	intron	-1,0,0,0,0,0,0,0,0,1,1	-2,0,0,0,0,0,0,0,0
chr22	41991062	41991093	CAAA	SEPT3	intron	-1,-1,0,0,0,0,0,0,0,0,0,1,1,1	-1,-1,0,0,0,0,0,1,1
chr22	41926181	41926216	CCAGGACCAGCG	TNFRSF13C	coding	-1,0,0,0,0,0,0	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
chr22	41991064	41991093	AACAAACAAACAAAC	SEPT3	intron	0,0,0,0,0,0,0,0,0,0,0,0,0,0	0,0,0,0,0,0,0,0,0
chr22	41976784	41976818	GCGGCTGGCAGCGGCG	SEPT3	promoter	0,0,0,0,0,0,0,0	0,0,0,0,0,0,0,0,0,0,0,0

TEST tandem-genotypes -u3 -s2 -g refFlat.txt simpleRepeat.txt nano.maf
# tandem-genotypes -u3 -s2 -g refFlat.txt simpleRepeat.txt nano.maf
chr22	41926181	41926216	CCAGGACCAGCG	TNFRSF13C	coding	-1,0,0,0,0,0,0	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
chr22	41976784	41976818	GCGGCTGGCAGCGGCG	SEPT3	promoter	0,0,0,0,0,0,0,0	0,0,0,0,0,0,0,0,0,0,0,0

TEST tandem-genotypes --postmask=0 slop3.bed slop3.maf
# tandem-genotypes --postmask=0 slop3.bed slop3.maf
chr9	27573529	27573546	GGGGCC	.	.	.	16

TEST tandem-genotypes -s2 -p900 -g refFlat.txt simpleRepeat.txt nano.maf
# tandem-genotypes -s2 -p900 -g refFlat.txt simpleRepeat.txt nano.maf
chr22	41994883	41994923	TG	SEPT3	3'UTR	-7,-6,-4,-3,-1,0,0,2,3,4,8	-16,-14,-12,-11,-11,-11,-9,-8,-7
chr22	41958483	41958508	GA	LINC00634	exon	-9,-8,-8,-8,-7,-7,-7,-4	-4,-4,-3,-2,-2,-2,-2,-2,-1,-1,-1,-1,0,1,1,2
chr22	41915069	41915109	GCTCCG	SHISA8	promoter	-1,0,0,0,0,0,1	-2,-1,0,0,0,0,0,0
chr22	41926181	41926216	CCAGGACCAGCG	TNFRSF13C	coding	-1,0,0,0,0,0,0	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
chr22	41976784	41976818	GCGGCTGGCAGCGGCG	SEPT3	promoter	0,0,0,0,0,0,0,0	0,0,0,0,0,0,0,0,0,0,0,0

TEST tandem-genotypes --postmask=0 ../hg38-disease-tr.txt far.maf
# tandem-genotypes --postmask=0 ../hg38-disease-tr.txt far.maf
chr3	63912685	63912715	GCA	ATXN7:SCA7	coding	64	.

TEST sed 's/chr//' far.maf | tandem-genotypes --postmask=0 far.bed
# tandem-genotypes --postmask=0 far.bed
chr3	63912686	63912715	CAG	.	.	64	.

